<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="team.xuli.toe.dao.IAddressDao">
    <insert id="insert" parameterType="team.xuli.toe.domain.Address" useGeneratedKeys="true" keyProperty="addressId">
        INSERT INTO `address`
        (`userId`,
        `type`,
        `calledName`,
        `phoneNo`,
        `addressDesc`,
        `longitude`,
        `latitude`,
        `status`)
        VALUES
        (#{userId},
        #{type},
        #{calledName},
        #{phoneNo},
        #{addressDesc},
        #{longitude},
        #{latitude},
        #{status});
    </insert>

    <select id="get" resultType="team.xuli.toe.domain.Address">
        SELECT
        `addressId`,
        `userId`,
        `type`,
        `calledName`,
        `phoneNo`,
        `addressDesc`,
        `longitude`,
        `latitude`,
        `status`
        FROM `address`
        WHERE `addressId` = #{addressId}
    </select>

    <select id="getAddresses" resultType="team.xuli.toe.domain.Address">
        SELECT
        `addressId`,
        `userId`,
        `type`,
        `calledName`,
        `phoneNo`,
        `addressDesc`,
        `longitude`,
        `latitude`,
        `status`
        FROM `address`
        WHERE `userId` = #{userId}
        AND `type` = #{type}
        AND `status` = 1;
    </select>

    <update id="update" parameterType="team.xuli.toe.domain.Address">
        UPDATE `address`
        SET
        <if test="userId > 0">`userId` = #{userId},</if>
        <if test="type >= 0">`type` = #{type},</if>
        <if test="calledName != '' and calledName != null ">`calledName` = #{calledName},</if>
        <if test="phoneNo != '' and phoneNo != null ">`phoneNo` = #{phoneNo},</if>
        <if test="addressDesc != '' and addressDesc != null ">
            `addressDesc` = #{addressDesc},
            `longitude` = #{longitude},
            `latitude` = #{latitude},
        </if>
        <if test="status == 0 || status == 1 ">`status` = #{status},</if>
        `addressId` = #{addressId}
        WHERE `addressId` = #{addressId};
    </update>
</mapper>

